<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Delivery Pro - Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙˆØµÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap');
        body { font-family: 'Cairo', sans-serif; background-color: #f3f4f6; }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        
        // =================================================================
        // 1. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© (Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­)
        // =================================================================
        const initialOrders = [
            { id: 101, customer: "Ø£Ø­Ù…Ø¯ Ø¨Ù†Ø§Ù†ÙŠ", address: "Ø­ÙŠ Ø§Ù„Ø³Ù„Ø§Ù…ØŒ Ø³Ù„Ø§", price: 150, status: "pending", driver: null },
            { id: 102, customer: "Ø³Ø§Ø±Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠ", address: "Ø£ÙƒØ¯Ø§Ù„ØŒ Ø§Ù„Ø±Ø¨Ø§Ø·", price: 300, status: "pending", driver: null },
            { id: 103, customer: "ÙƒØ±ÙŠÙ… Ø§Ù„ØªØ§Ø²ÙŠ", address: "Ø­ÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ø±Ø¨Ø§Ø·", price: 120, status: "delivered", driver: "Ø¹Ù…Ø±" },
            { id: 104, customer: "Ù…Ù†Ù‰ Ø§Ù„Ø´Ø§ÙˆÙŠ", address: "ØªØ§Ø¨Ø±ÙŠÙƒØªØŒ Ø³Ù„Ø§", price: 200, status: "pending", driver: null },
            { id: 105, customer: "ÙŠÙˆØ³Ù Ø§Ù„Ø¹Ù…Ø±Ø§Ù†ÙŠ", address: "Ø§Ù„Ù…Ø­ÙŠØªØŒ Ø§Ù„Ø±Ø¨Ø§Ø·", price: 450, status: "assigned", driver: "Ø®Ø§Ù„Ø¯" },
        ];

        const driversList = [
            { id: 1, name: "Ø¹Ù…Ø± (Ù…ØªØ§Ø­)", available: true },
            { id: 2, name: "Ø®Ø§Ù„Ø¯ (Ù…Ø´ØºÙˆÙ„)", available: false },
            { id: 3, name: "ÙŠØ§Ø³ÙŠÙ† (Ù…ØªØ§Ø­)", available: true }
        ];

        // =================================================================
        // 2. Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (SmartDeliveryApp)
        // =================================================================
        function SmartDeliveryApp() {
            
            // --- Ø§Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚ (State) ---
            const [orders, setOrders] = React.useState(initialOrders);
            const [view, setView] = React.useState('admin'); // 'admin' Ø£Ùˆ 'driver'
            
            // --- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª (ØªØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹) ---
            const stats = {
                total: orders.length,
                pending: orders.filter(o => o.status === 'pending').length,
                delivered: orders.filter(o => o.status === 'delivered').length,
                revenue: orders.filter(o => o.status === 'delivered').reduce((acc, curr) => acc + curr.price, 0)
            };

            // --- Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø°ÙƒÙŠ (AI Simulation) ---
            // Ù‡Ø§Ø¯ÙŠ Ù‡ÙŠ Ø§Ù„Ù„ÙŠ ØºØªØ¨Ù‡Ø± Ø¨ÙŠÙ‡Ù… Ø§Ù„Ù„Ø¬Ù†Ø©: ÙƒØªÙˆØ²Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ† Ø§Ù„Ù…ØªØ§Ø­ÙŠÙ†
            const autoAssign = () => {
                const newOrders = [...orders];
                const availableDrivers = driversList.filter(d => d.available);
                
                let driverIndex = 0;
                let assignedCount = 0;

                newOrders.forEach(order => {
                    if (order.status === 'pending' && availableDrivers.length > 0) {
                        // Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø¨Ø§Ù„ØªÙ†Ø§ÙˆØ¨ (Round Robin)
                        order.driver = availableDrivers[driverIndex].name;
                        order.status = 'assigned';
                        driverIndex = (driverIndex + 1) % availableDrivers.length;
                        assignedCount++;
                    }
                });

                setOrders(newOrders);
                if(assignedCount > 0) alert(`ðŸ¤– ØªÙ… ØªÙˆØ²ÙŠØ¹ ${assignedCount} Ø·Ù„Ø¨Ø§Øª Ø°ÙƒÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ† Ø§Ù„Ù…ØªØ§Ø­ÙŠÙ†!`);
                else alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ø£Ùˆ Ù…ÙˆØ²Ø¹ÙŠÙ† Ù…ØªØ§Ø­ÙŠÙ†.");
            };

            // --- Ø¯Ø§Ù„Ø© ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø© (Ù„Ù„Ù…ÙˆØ²Ø¹) ---
            const updateStatus = (id, newStatus) => {
                setOrders(orders.map(o => o.id === id ? { ...o, status: newStatus } : o));
            };

            return (
                <div className="flex h-screen overflow-hidden">
                    
                    {/* === Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© (Sidebar) === */}
                    <aside className="w-64 bg-gray-900 text-white flex flex-col hidden md:flex">
                        <div className="p-6 text-2xl font-bold text-center border-b border-gray-700">
                            <i className="fa-solid fa-rocket text-blue-500 ml-2"></i>
                            ØªÙˆØµÙŠÙ„ <span className="text-blue-400">Ø¨Ø±Ùˆ</span>
                        </div>
                        <nav className="flex-1 p-4 space-y-2">
                            <button onClick={() => setView('admin')} className={`w-full text-right p-3 rounded transition ${view === 'admin' ? 'bg-blue-600' : 'hover:bg-gray-800'}`}>
                                <i className="fa-solid fa-chart-line ml-3 w-6"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                            </button>
                            <button onClick={() => setView('driver')} className={`w-full text-right p-3 rounded transition ${view === 'driver' ? 'bg-green-600' : 'hover:bg-gray-800'}`}>
                                <i className="fa-solid fa-motorcycle ml-3 w-6"></i> ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…ÙˆØ²Ø¹
                            </button>
                        </nav>
                        <div className="p-4 text-xs text-gray-500 text-center">
                            Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ v1.0 (Demo)
                        </div>
                    </aside>

                    {/* === Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ === */}
                    <main className="flex-1 flex flex-col h-screen overflow-y-auto">
                        
                        {/* Header Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */}
                        <header className="bg-white p-4 shadow-sm flex justify-between items-center md:hidden">
                            <div className="font-bold text-lg">ØªÙˆØµÙŠÙ„ Ø¨Ø±Ùˆ</div>
                            <div className="flex gap-2">
                                <button onClick={() => setView('admin')} className="text-sm bg-gray-200 p-2 rounded">Ø¥Ø¯Ø§Ø±Ø©</button>
                                <button onClick={() => setView('driver')} className="text-sm bg-gray-200 p-2 rounded">Ù…ÙˆØ²Ø¹</button>
                            </div>
                        </header>

                        {/* === Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Admin View) === */}
                        {view === 'admin' && (
                            <div className="p-6 md:p-10">
                                <div className="flex justify-between items-center mb-8">
                                    <h1 className="text-3xl font-bold text-gray-800">Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©</h1>
                                    <button onClick={autoAssign} className="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg shadow-lg flex items-center transition transform hover:scale-105">
                                        <i className="fa-solid fa-wand-magic-sparkles ml-2"></i> ØªÙˆØ²ÙŠØ¹ Ø°ÙƒÙŠ (AI)
                                    </button>
                                </div>

                                {/* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */}
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-6 mb-10">
                                    <StatCard title="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª" value={stats.total} icon="fa-box" color="blue" />
                                    <StatCard title="Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±" value={stats.pending} icon="fa-clock" color="yellow" />
                                    <StatCard title="ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„" value={stats.delivered} icon="fa-check-circle" color="green" />
                                    <StatCard title="Ø§Ù„Ø£Ø±Ø¨Ø§Ø­" value={stats.revenue + ' DH'} icon="fa-wallet" color="purple" />
                                </div>

                                {/* Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª */}
                                <div className="bg-white rounded-xl shadow-md overflow-hidden">
                                    <div className="p-6 border-b border-gray-100 flex justify-between items-center">
                                        <h3 className="font-bold text-lg">Ø£Ø­Ø¯Ø« Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
                                        <span className="text-sm text-gray-500">ØªØ­Ø¯ÙŠØ« Ù…Ø¨Ø§Ø´Ø±</span>
                                    </div>
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-right">
                                            <thead className="bg-gray-50 text-gray-600 text-sm uppercase">
                                                <tr>
                                                    <th className="p-4">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                                                    <th className="p-4">Ø§Ù„Ø²Ø¨ÙˆÙ†</th>
                                                    <th className="p-4">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                                                    <th className="p-4">Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                                    <th className="p-4">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                                    <th className="p-4">Ø§Ù„Ù…ÙˆØ²Ø¹</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-gray-100">
                                                {orders.map(order => (
                                                    <tr key={order.id} className="hover:bg-gray-50 transition">
                                                        <td className="p-4 font-bold">#{order.id}</td>
                                                        <td className="p-4">{order.customer}</td>
                                                        <td className="p-4 text-gray-500">{order.address}</td>
                                                        <td className="p-4 font-bold text-gray-800">{order.price} DH</td>
                                                        <td className="p-4">
                                                            <span className={`px-3 py-1 rounded-full text-xs font-bold ${
                                                                order.status === 'pending' ? 'bg-yellow-100 text-yellow-700' :
                                                                order.status === 'assigned' ? 'bg-blue-100 text-blue-700' :
                                                                'bg-green-100 text-green-700'
                                                            }`}>
                                                                {order.status === 'pending' ? 'Ø§Ù†ØªØ¸Ø§Ø±' : 
                                                                 order.status === 'assigned' ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØµÙŠÙ„' : 'Ù…ÙƒØªÙ…Ù„'}
                                                            </span>
                                                        </td>
                                                        <td className="p-4 text-sm">
                                                            {order.driver ? (
                                                                <span className="flex items-center text-gray-700">
                                                                    <i className="fa-solid fa-helmet-safety ml-2 text-gray-400"></i> {order.driver}
                                                                </span>
                                                            ) : (
                                                                <span className="text-gray-400 text-xs italic">-- ØºÙŠØ± Ù…Ø¹ÙŠÙ† --</span>
                                                            )}
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* === Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ²Ø¹ (Driver View) === */}
                        {view === 'driver' && (
                            <div className="p-6 md:p-10 max-w-2xl mx-auto w-full">
                                <h2 className="text-2xl font-bold mb-6 flex items-center">
                                    <i className="fa-solid fa-motorcycle ml-3 text-green-600"></i>
                                    ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ÙˆØ²Ø¹ (Live App)
                                </h2>
                                
                                <div className="space-y-4">
                                    {orders.filter(o => o.status === 'assigned').length === 0 && (
                                        <div className="text-center p-10 bg-white rounded-xl shadow border border-dashed border-gray-300 text-gray-500">
                                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø¬Ø¯ÙŠØ¯Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ðŸ˜´
                                        </div>
                                    )}

                                    {orders.filter(o => o.status === 'assigned').map(order => (
                                        <div key={order.id} className="bg-white p-6 rounded-xl shadow-lg border-r-4 border-blue-500 transform transition hover:scale-102">
                                            <div className="flex justify-between items-start mb-4">
                                                <div>
                                                    <span className="text-xs font-bold text-gray-400 block mb-1">Ø·Ù„Ø¨ #{order.id}</span>
                                                    <h3 className="text-xl font-bold">{order.customer}</h3>
                                                </div>
                                                <div className="bg-blue-50 text-blue-600 px-3 py-1 rounded-lg font-bold">
                                                    {order.price} DH
                                                </div>
                                            </div>
                                            
                                            <div className="mb-6 flex items-center text-gray-600 bg-gray-50 p-3 rounded-lg">
                                                <i className="fa-solid fa-location-dot ml-3 text-red-500 text-xl"></i>
                                                {order.address}
                                            </div>

                                            <div className="flex gap-3">
                                                <button className="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300">
                                                    <i className="fa-solid fa-phone"></i> Ø§ØªØµØ§Ù„
                                                </button>
                                                <button 
                                                    onClick={() => {
                                                        if(confirm('ØªØ£ÙƒÙŠØ¯ ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ù…Ø¨Ù„ØºØŸ')) updateStatus(order.id, 'delivered');
                                                    }}
                                                    className="flex-1 bg-green-600 text-white py-3 rounded-lg font-bold hover:bg-green-700 shadow-md transition"
                                                >
                                                    <i className="fa-solid fa-check"></i> ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                    </main>
                </div>
            );
        }

        // Ù…ÙƒÙˆÙ† Ø¨Ø³ÙŠØ· Ù„Ù„Ø¨Ø·Ø§Ù‚Ø© (StatCard)
        function StatCard({ title, value, icon, color }) {
            const colors = {
                blue: "bg-blue-500", yellow: "bg-yellow-500", green: "bg-green-500", purple: "bg-purple-600"
            };
            return (
                <div className="bg-white p-5 rounded-xl shadow-sm border border-gray-100 flex items-center">
                    <div className={`w-12 h-12 rounded-full flex items-center justify-center text-white ${colors[color]} ml-4 shadow-md`}>
                        <i className={`fa-solid ${icon}`}></i>
                    </div>
                    <div>
                        <div className="text-gray-500 text-sm">{title}</div>
                        <div className="text-2xl font-bold text-gray-800">{value}</div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SmartDeliveryApp />);

    </script>
</body>
</html>

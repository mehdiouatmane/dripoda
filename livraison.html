<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Delivery - Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙŠØ¯ÙˆÙŠØ©</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap');
        body { font-family: 'Cairo', sans-serif; background-color: #f3f4f6; }
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        .mobile-card { transition: all 0.3s ease; }
        .mobile-card:active { transform: scale(0.98); }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        
        // 1. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        const initialOrders = [
            { id: 101, customer: "Ø£Ø­Ù…Ø¯ Ø¨Ù†Ø§Ù†ÙŠ", phone: "0661123456", address: "Ø­ÙŠ Ø§Ù„Ø³Ù„Ø§Ù…ØŒ Ø³Ù„Ø§", price: 150, status: "pending", driver: "" },
            { id: 102, customer: "Ø³Ø§Ø±Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠ", phone: "0661987654", address: "Ø£ÙƒØ¯Ø§Ù„ØŒ Ø§Ù„Ø±Ø¨Ø§Ø·", price: 300, status: "pending", driver: "" },
            { id: 103, customer: "ÙƒØ±ÙŠÙ… Ø§Ù„ØªØ§Ø²ÙŠ", phone: "0661000000", address: "Ø­ÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ø±Ø¨Ø§Ø·", price: 120, status: "delivered", driver: "Ø¹Ù…Ø±" },
            { id: 104, customer: "Ù…Ù†Ù‰ Ø§Ù„Ø´Ø§ÙˆÙŠ", phone: "0661112233", address: "ØªØ§Ø¨Ø±ÙŠÙƒØªØŒ Ø³Ù„Ø§", price: 200, status: "pending", driver: "" },
            { id: 105, customer: "ÙŠÙˆØ³Ù Ø§Ù„Ø¹Ù…Ø±Ø§Ù†ÙŠ", phone: "0661445566", address: "Ø§Ù„Ù…Ø­ÙŠØ·ØŒ Ø§Ù„Ø±Ø¨Ø§Ø·", price: 450, status: "pending", driver: "" },
        ];

        const driversList = ["Ø¹Ù…Ø±", "Ø®Ø§Ù„Ø¯", "ÙŠØ§Ø³ÙŠÙ†"];

        function SmartDeliveryApp() {
            // State
            const [orders, setOrders] = React.useState(initialOrders);
            const [view, setView] = React.useState('admin'); 
            const [currentDriver, setCurrentDriver] = React.useState('Ø¹Ù…Ø±'); // Ø§Ù„Ù…ÙˆØ²Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ (Ù„Ù„ØªØ¬Ø±Ø¨Ø©)

            // --- Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ---
            const handleAssignDriver = (orderId, driverName) => {
                setOrders(orders.map(order => 
                    order.id === orderId ? { ...order, driver: driverName, status: driverName ? 'assigned' : 'pending' } : order
                ));
            };

            const saveAssignments = () => {
                const assignedCount = orders.filter(o => o.status === 'assigned').length;
                alert(`âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø¨Ù†Ø¬Ø§Ø­!\nØ¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙˆØ²Ø¹Ø© Ø­Ø§Ù„ÙŠØ§Ù‹: ${assignedCount}`);
            };

            // --- Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ÙˆØ²Ø¹ ---
            const updateOrderStatus = (id, newStatus) => {
                if(confirm('ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©ØŸ')) {
                    setOrders(orders.map(o => o.id === id ? { ...o, status: newStatus } : o));
                }
            };

            return (
                <div className="flex h-screen overflow-hidden bg-gray-100">
                    
                    {/* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© (Desktop) */}
                    <aside className="w-64 bg-slate-900 text-white flex-col hidden md:flex shadow-2xl z-20">
                        <div className="p-6 text-2xl font-bold border-b border-gray-700 text-center">
                            <i className="fa-solid fa-truck-fast text-yellow-400 ml-2"></i>
                            ØªÙˆØµÙŠÙ„ <span className="text-yellow-400">Pro</span>
                        </div>
                        <nav className="flex-1 p-4 space-y-3">
                            <button onClick={() => setView('admin')} className={`w-full text-right p-4 rounded-xl flex items-center gap-3 transition-all ${view === 'admin' ? 'bg-blue-600 shadow-lg translate-x-1' : 'hover:bg-slate-800'}`}>
                                <i className="fa-solid fa-user-tie text-xl"></i> Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ©
                            </button>
                            <button onClick={() => setView('driver')} className={`w-full text-right p-4 rounded-xl flex items-center gap-3 transition-all ${view === 'driver' ? 'bg-green-600 shadow-lg translate-x-1' : 'hover:bg-slate-800'}`}>
                                <i className="fa-solid fa-motorcycle text-xl"></i> ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ÙˆØ²Ø¹
                            </button>
                        </nav>
                    </aside>

                    {/* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */}
                    <main className="flex-1 flex flex-col h-screen overflow-y-auto">
                        
                        {/* Header Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */}
                        <div className="md:hidden bg-white p-4 shadow-md flex justify-between items-center sticky top-0 z-30">
                            <h1 className="font-bold text-lg text-slate-800">ØªÙˆØµÙŠÙ„ Pro</h1>
                            <div className="flex gap-2">
                                <button onClick={() => setView('admin')} className={`px-4 py-2 rounded-lg text-sm font-bold ${view === 'admin' ? 'bg-blue-600 text-white' : 'bg-gray-100'}`}>Ø¥Ø¯Ø§Ø±Ø©</button>
                                <button onClick={() => setView('driver')} className={`px-4 py-2 rounded-lg text-sm font-bold ${view === 'driver' ? 'bg-green-600 text-white' : 'bg-gray-100'}`}>Ù…ÙˆØ²Ø¹</button>
                            </div>
                        </div>

                        {/* ========================================================
                           1. ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Admin View) - ØªÙˆØ²ÙŠØ¹ ÙŠØ¯ÙˆÙŠ
                           ======================================================== */}
                        {view === 'admin' && (
                            <div className="p-4 md:p-8 max-w-7xl mx-auto w-full">
                                
                                <div className="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
                                    <div>
                                        <h2 className="text-3xl font-black text-slate-800 mb-1">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
                                        <p className="text-gray-500 text-sm">Ù‚Ù… Ø¨Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ²Ø¹ Ù„ÙƒÙ„ Ø²Ø¨ÙˆÙ† Ø«Ù… Ø§Ø¶ØºØ· Ø­ÙØ¸</p>
                                    </div>
                                    <button onClick={saveAssignments} className="w-full md:w-auto bg-slate-900 hover:bg-slate-800 text-white px-8 py-3 rounded-xl shadow-lg flex items-center justify-center gap-2 transition transform active:scale-95">
                                        <i className="fa-solid fa-floppy-disk"></i> Ø­ÙØ¸ Ø§Ù„ØªÙˆØ²ÙŠØ¹
                                    </button>
                                </div>

                                {/* Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ (Desktop Table) */}
                                <div className="hidden md:block bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                                    <table className="w-full text-right">
                                        <thead className="bg-gray-50 text-gray-600 text-sm uppercase font-bold border-b">
                                            <tr>
                                                <th className="p-5">Ø§Ù„Ø·Ù„Ø¨</th>
                                                <th className="p-5">Ø§Ù„Ø²Ø¨ÙˆÙ†</th>
                                                <th className="p-5">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                                                <th className="p-5">Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                                <th className="p-5">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                                <th className="p-5 w-64 text-center bg-blue-50 text-blue-800">ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ÙˆØ²Ø¹ ğŸ¯</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-100">
                                            {orders.map(order => (
                                                <tr key={order.id} className="hover:bg-gray-50 transition">
                                                    <td className="p-5 font-bold text-gray-400">#{order.id}</td>
                                                    <td className="p-5 font-bold text-gray-800">{order.customer}</td>
                                                    <td className="p-5 text-gray-500 text-sm">{order.address}</td>
                                                    <td className="p-5 font-bold text-green-600">{order.price} DH</td>
                                                    <td className="p-5">
                                                        <span className={`px-3 py-1 rounded-full text-xs font-bold ${
                                                            order.status === 'delivered' ? 'bg-green-100 text-green-700' :
                                                            order.status === 'assigned' ? 'bg-blue-100 text-blue-700' : 'bg-yellow-100 text-yellow-700'
                                                        }`}>
                                                            {order.status === 'delivered' ? 'Ù…ÙƒØªÙ…Ù„' : order.status === 'assigned' ? 'Ù…ÙˆØ²Ø¹' : 'Ø¬Ø¯ÙŠØ¯'}
                                                        </span>
                                                    </td>
                                                    <td className="p-5 bg-blue-50/30">
                                                        {order.status !== 'delivered' ? (
                                                            <select 
                                                                value={order.driver}
                                                                onChange={(e) => handleAssignDriver(order.id, e.target.value)}
                                                                className="w-full bg-white border-2 border-blue-200 text-gray-800 rounded-lg p-2 focus:border-blue-500 focus:outline-none cursor-pointer font-bold"
                                                            >
                                                                <option value="">-- Ø§Ø®ØªØ± --</option>
                                                                {driversList.map(d => <option key={d} value={d}>{d}</option>)}
                                                            </select>
                                                        ) : (
                                                            <div className="text-center text-green-600 font-bold text-sm">
                                                                <i className="fa-solid fa-check"></i> ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… ({order.driver})
                                                            </div>
                                                        )}
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>

                                {/* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ (Mobile Cards) */}
                                <div className="md:hidden space-y-4">
                                    {orders.map(order => (
                                        <div key={order.id} className="mobile-card bg-white p-5 rounded-2xl shadow-sm border border-gray-100 relative overflow-hidden">
                                            {/* Ø´Ø±ÙŠØ· Ø¬Ø§Ù†Ø¨ÙŠ Ù…Ù„ÙˆÙ† */}
                                            <div className={`absolute top-0 right-0 w-1.5 h-full ${order.status === 'delivered' ? 'bg-green-500' : order.driver ? 'bg-blue-500' : 'bg-yellow-400'}`}></div>
                                            
                                            <div className="flex justify-between items-start mb-3 mr-3">
                                                <div>
                                                    <h3 className="font-bold text-lg text-slate-800">{order.customer}</h3>
                                                    <p className="text-gray-400 text-xs">#{order.id} â€¢ {order.address}</p>
                                                </div>
                                                <div className="text-lg font-bold text-slate-800">{order.price} DH</div>
                                            </div>

                                            <div className="mr-3 mt-4">
                                                <label className="text-xs font-bold text-blue-600 mb-2 block">ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ÙˆØ²Ø¹:</label>
                                                {order.status !== 'delivered' ? (
                                                    <select 
                                                        value={order.driver}
                                                        onChange={(e) => handleAssignDriver(order.id, e.target.value)}
                                                        className="w-full bg-gray-50 border border-gray-200 text-gray-800 rounded-xl p-3 focus:ring-2 focus:ring-blue-500 outline-none font-bold"
                                                    >
                                                        <option value="">-- Ø¨Ø¯ÙˆÙ† Ù…ÙˆØ²Ø¹ --</option>
                                                        {driversList.map(d => <option key={d} value={d}>{d}</option>)}
                                                    </select>
                                                ) : (
                                                    <div className="bg-green-50 text-green-700 p-2 rounded-lg text-center font-bold text-sm">
                                                        ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… Ø¨ÙˆØ§Ø³Ø·Ø© {order.driver}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* ========================================================
                           2. ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ÙˆØ²Ø¹ (Driver App) - Ù…Ø­Ø§ÙƒØ§Ø©
                           ======================================================== */}
                        {view === 'driver' && (
                            <div className="p-4 md:p-8 max-w-md mx-auto w-full">
                                
                                {/* ğŸ”´ Ù…Ø­Ø§ÙƒØ§Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Switch Accounts) */}
                                <div className="bg-slate-800 text-white p-4 rounded-2xl mb-6 shadow-lg">
                                    <p className="text-xs text-slate-400 mb-2 text-center">-- Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù‡Ø§ØªÙ --</p>
                                    <label className="text-sm font-bold block mb-2">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨ØµÙØªÙƒ:</label>
                                    <div className="flex bg-slate-700 p-1 rounded-xl">
                                        {driversList.map(d => (
                                            <button 
                                                key={d}
                                                onClick={() => setCurrentDriver(d)}
                                                className={`flex-1 py-2 rounded-lg text-sm font-bold transition ${currentDriver === d ? 'bg-white text-slate-900 shadow' : 'text-slate-300 hover:bg-slate-600'}`}
                                            >
                                                {d}
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                <h2 className="text-2xl font-bold mb-4 flex items-center gap-2">
                                    <span>Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ {currentDriver} ğŸ‘‹</span>
                                </h2>

                                <div className="space-y-4">
                                    {/* ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª: Ø¥Ø¸Ù‡Ø§Ø± ÙÙ‚Ø· Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙˆØ²Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ */}
                                    {orders.filter(o => o.driver === currentDriver && o.status !== 'delivered').length === 0 ? (
                                        <div className="text-center py-12 bg-white rounded-2xl border-2 border-dashed border-gray-200">
                                            <i className="fa-solid fa-mug-hot text-4xl text-gray-300 mb-3 block"></i>
                                            <p className="text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø¬Ø¯ÙŠØ¯Ø© Ù„Ùƒ ÙŠØ§ {currentDriver}</p>
                                        </div>
                                    ) : (
                                        orders.filter(o => o.driver === currentDriver && o.status !== 'delivered').map(order => (
                                            <div key={order.id} className="bg-white p-6 rounded-2xl shadow-md border-r-4 border-green-500 animate-fade-in transform transition hover:-translate-y-1">
                                                <div className="flex justify-between items-start mb-4">
                                                    <div>
                                                        <span className="bg-gray-100 text-gray-500 px-2 py-0.5 rounded text-xs font-bold">#{order.id}</span>
                                                        <h3 className="text-xl font-bold mt-1">{order.customer}</h3>
                                                    </div>
                                                    <div className="bg-green-50 text-green-700 px-3 py-1 rounded-lg font-bold text-lg">
                                                        {order.price} DH
                                                    </div>
                                                </div>
                                                
                                                <div className="bg-gray-50 p-3 rounded-xl mb-5 flex items-center gap-3 text-gray-600">
                                                    <i className="fa-solid fa-location-dot text-red-500 text-xl"></i>
                                                    <span className="font-medium text-sm">{order.address}</span>
                                                </div>

                                                <div className="flex gap-3">
                                                    <a href={`tel:${order.phone}`} className="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 py-3 rounded-xl font-bold flex items-center justify-center gap-2 transition">
                                                        <i className="fa-solid fa-phone"></i> Ø§ØªØµØ§Ù„
                                                    </a>
                                                    <button 
                                                        onClick={() => updateOrderStatus(order.id, 'delivered')}
                                                        className="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold flex items-center justify-center gap-2 shadow-lg shadow-green-200 transition"
                                                    >
                                                        <i className="fa-solid fa-check"></i> ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…
                                                    </button>
                                                </div>
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>
                        )}

                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SmartDeliveryApp />);

    </script>
</body>
</html>
